<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Typed Scanner Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preload" href="./report.css" as="style">
  <link rel="stylesheet" href="./report.css">
</head>
<body>
  <header class="site-header">
    <div class="title">
      <h1>Typed Scanner • Report</h1>
      <p class="subtitle">CSV & JSONL tokenization • performance & parsing health</p>
    </div>
    <nav class="actions">
      <a href="/" class="btn btn-link">🏠 Home</a>
      <button id="toggle-theme" class="btn">🌗 Theme</button>
      <a id="download-json" class="btn btn-outline" href="#" download="run.json">Download JSON</a>
    </nav>
  </header>

  <main class="container">
    {{> cards}}

    <aside class="toc">
      <a href="#comparison">Before vs After</a>
      <a href="#charts">Charts</a>
      <a href="#tables">Tables</a>
    </aside>

    <section id="comparison" class="panel">
      <h2>Before vs After</h2>
      <p class="muted">If a baseline (“before”) run is provided, deltas are shown below.</p>
      <div id="compare-kpis" class="kpi-compare-grid"></div>
      <div class="charts-grid">
        <div class="chart-card">
          <h3>Throughput (Tokens/sec)</h3>
          <div id="chart-compare-tokens"></div>
        </div>
        <div class="chart-card">
          <h3>Wall Throughput (MB/s)</h3>
          <div id="chart-compare-mbs"></div>
        </div>
        <div class="chart-card">
          <h3>Latency (p95 ms — lower is better)</h3>
          <div id="chart-compare-lat"></div>
        </div>
        <div class="chart-card">
          <h3>Peak RSS (MB)</h3>
          <div id="chart-compare-rss"></div>
        </div>
      </div>
    </section>

    <section id="charts" class="panel">
      <h2>Charts</h2>
      {{> charts}}
    </section>

    <section id="tables" class="panel">
      <h2>Tables</h2>
      {{> tables}}
    </section>
  </main>

  <footer class="site-footer">
    <span>Typed Scanner • generated {{date}}</span>
  </footer>

  <!-- Inline JSON is OK under CSP because it's not executable -->
  <script id="run-data" type="application/json">{{{ctx}}}</script>

  <!-- vendor libs copied next to report.html -->
  <script src="./vega.min.js" defer></script>
  <script src="./vega-lite.min.js" defer></script>
  <script src="./vega-embed.min.js" defer></script>

  <!-- our app code (external to satisfy CSP) -->
  <script src="./report.js" defer></script>
</body>
</html>
